<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Kortlek</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1 id="app-name">Laddar...</h1>
    <p class="subtitle" id="app-subtitle"></p>

    <!-- Deck selector (shown when no deck is selected) -->
    <div class="deck-selector" id="deck-selector" style="display: none;">
        <div class="deck-list" id="deck-list"></div>
        <button class="create-deck-btn" onclick="openCreateDeckModal()">+ Skapa ny kortlek</button>
    </div>

    <div class="collection-selector" id="collection-selector"></div>

    <div class="card-area">
        <div id="card-display">
            <div class="placeholder" id="placeholder-text"></div>
        </div>

        <p class="cards-remaining" id="remaining"></p>

        <div class="deck">
            <div class="deck-buttons">
                <button class="deck-mode-btn" onclick="drawRandomCard()" title="Dra slumpat kort" id="btn-draw-random"></button>
                <button class="deck-mode-btn" onclick="drawNextCard()" title="Dra n√§sta kort" id="btn-draw-next"></button>
            </div>
            <div class="deck-card" onclick="drawCard()"></div>
            <div class="deck-card" onclick="drawCard()"></div>
            <div class="deck-card" onclick="drawCard()">
                <span class="deck-icon" id="deck-icon"></span>
            </div>
        </div>

        <button class="shuffle-btn" onclick="shuffleDeck()" id="btn-reset"></button>
    </div>

    <!-- Modal for creating/editing collections -->
    <div class="modal-overlay" id="create-modal">
        <div class="modal">
            <h3 id="modal-title"></h3>
            <input type="text" id="collection-name-input">
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeModal()" id="btn-cancel-create"></button>
                <button class="modal-btn primary" onclick="saveCollection()" id="btn-save"></button>
            </div>
        </div>
    </div>

    <!-- Modal for confirming deletion -->
    <div class="modal-overlay" id="delete-modal">
        <div class="modal">
            <h3 id="delete-modal-title"></h3>
            <p style="color: #666; margin-bottom: 15px;" id="delete-confirm-text"></p>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeDeleteModal()" id="btn-cancel-delete"></button>
                <button class="modal-btn danger" onclick="confirmDeleteCollection()" id="btn-delete"></button>
            </div>
        </div>
    </div>

    <!-- Modal for managing a collection -->
    <div class="modal-overlay" id="manage-modal">
        <div class="modal">
            <h3 id="manage-modal-title"></h3>
            <div class="modal-buttons" style="flex-direction: column; align-items: stretch;">
                <button class="modal-btn secondary" onclick="editCollectionName()" style="text-align: left;" id="btn-rename"></button>
                <button class="modal-btn danger" onclick="showDeleteModal()" style="text-align: left;" id="btn-delete-collection"></button>
            </div>
            <div class="collection-actions">
                <button class="modal-btn secondary" onclick="closeManageModal()" style="width: 100%;" id="btn-close"></button>
            </div>
        </div>
    </div>

    <!-- Modal for admin password -->
    <div class="modal-overlay" id="admin-password-modal">
        <div class="modal">
            <h3>Admin-l√∂senord</h3>
            <p style="color: #666; margin-bottom: 15px; font-size: 0.9rem;">Ange l√∂senord f√∂r att skapa kortlekar</p>
            <input type="password" id="admin-password-input" placeholder="L√∂senord">
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeAdminPasswordModal()">Avbryt</button>
                <button class="modal-btn primary" onclick="verifyAdminPassword()">Forts√§tt</button>
            </div>
        </div>
    </div>

    <!-- Modal for creating/importing a deck -->
    <div class="modal-overlay" id="create-deck-modal">
        <div class="modal modal-wide">
            <h3>Skapa ny kortlek</h3>

            <div class="form-group">
                <label for="deck-id-input">ID (anv√§nds i URL)</label>
                <input type="text" id="deck-id-input" placeholder="t.ex. minlek">
            </div>

            <div class="form-group">
                <label for="deck-name-input">Namn</label>
                <input type="text" id="deck-name-input" placeholder="Kortlekens namn">
            </div>

            <div class="form-group">
                <label for="deck-subtitle-input">Undertitel (valfritt)</label>
                <input type="text" id="deck-subtitle-input" placeholder="En kort beskrivning">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="deck-icon-input">Ikon</label>
                    <input type="text" id="deck-icon-input" placeholder="üÉè" value="üÉè">
                </div>

                <div class="form-group">
                    <label for="deck-color-input">Bakgrund</label>
                    <input type="color" id="deck-color-input" value="#669e6a">
                </div>

                <div class="form-group">
                    <label for="deck-textcolor-input">Text</label>
                    <input type="color" id="deck-textcolor-input" value="#ffffff">
                </div>

                <div class="form-group">
                    <label for="deck-public-input">Publik</label>
                    <input type="checkbox" id="deck-public-input" checked>
                </div>
            </div>

            <div class="form-group">
                <label for="deck-csv-input">Importera kort (CSV)</label>
                <input type="file" id="deck-csv-input" accept=".csv">
                <p class="form-hint">Format: category,icon,title,description,tip</p>
            </div>

            <div id="csv-preview" class="csv-preview"></div>

            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeCreateDeckModal()">Avbryt</button>
                <button class="modal-btn primary" onclick="saveDeck()">Skapa kortlek</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <!-- App scripts -->
    <script src="firebase-config.js"></script>
    <script src="icons.js"></script>
    <script src="app.js"></script>
</body>
</html>
